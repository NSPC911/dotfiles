# requires: https://github.com/astral-sh/ruff
[language-server.ruff]
command = "ruff"
args = ["server"]

[language-server.ruff.config]
disableLanguageServices = true

# requires: https://github.com/astral-sh/ruff
[language-server.ty]
command = "ty"
args = ["server"]

[language-server.ty.config]
disableLanguageServices = true

# requires: https://github.com/DetachHead/basedpyright
[language-server.basedpyright]
command = "basedpyright-langserver"
args = ["--stdio"]

[language-server.basedpyright.config]
reportMissingTypeStubs = true

[language-server.basedpyright.config.python.analysis]
typeCheckingMode = "off"
autoImportCompletions = true

[language-server.basedpyright.config.python.analysis.inlayHints]
variableTypes = true
parameterNames = true
functionReturnTypes = true
callArgumentNames = true

[language-server.basedpyright.config.python.analysis.diagnosticSeverityOverrides]
reportUndefinedVariable = "none"

# requires: https://github.com/Automattic/harper
[language-server.harper-ls]
command = "harper-ls"
args = ["--stdio"]

[language-server.harper-ls.config.harper-ls]
dialact = "British"  # shit is not british
isolateEnglish = true

[language-server.harper-ls.config.harper-ls.linters]
UnclosedQuotes = true
WrongQuotes = true
LongSentences = true
RepeatedWords = true
SpellCheck = true
SentenceCapitalization = false
NoOxfordComma = false
SpelledNumbers = false

[language-server.harper-ls.config.markdown]
IgnoreLinkTitle = true

# requires helix be built with `cargo xtask steel`
# on a supported branch
[language-server.steel]
command = "steel-language-server"
args = []

# requires: https://github.com/facebook/pyrefly/
# i don't use it currently
[language-server.pyrefly]
command = "pyrefly"
args = ["lsp"]

# requires: https://github.com/tombi-toml/tombi
[language-server.tombi]
command = "tombi"
args = ["--no-cache", "lsp"]

# requires: https://github.com/zerootoad/discord-rpc-lsp
[language-server.discord-rpc]
command = "discord-rpc-lsp"

[[language]]
name = "python"
language-servers = [
  "discord-rpc",
  "harper-ls",
  "basedpyright",
  "ruff",
]
auto-format = true

[[language]]
name = "scss"
file-types = ["scss", "tcss"]
injection-regex = "(t|s)?css"
language-servers = [
  "discord-rpc",
  "vscode-css-language-server",
]

[[language]]
name = "scheme"
language-servers = [
  "discord-rpc",
  "steel",
]

[[language]]
name = "json"
formatter = { command = "prettierd", args = [".json"] }
language-servers = [
  "discord-rpc",
  "vscode-json-language-server",
]
auto-format = true

[[language]]
name = "javascript"
formatter = { command = "pretterd", args = [".js"] }
language-servers = [
  "discord-rpc",
  "typescript-language-server",
]
auto-format = true

[[language]]
name = "jsonc"
formatter = { command = "prettierd", args = [".jsonc"] }
language-servers = [
  "discord-rpc",
  "vscode-json-language-server",
]
auto-format = true

[[language]]
name = "yaml"
formatter = { command = "prettierd", args = [".yaml"] }
language-servers = [
  "ansible-language-server",
  "discord-rpc",
  "yaml-language-server",
]

[[language]]
name = "css"
formatter = { command = "prettierd", args = [".css"] }
language-servers = [
  "discord-rpc",
  "vscode-css-language-server",
]

[[language]]
name = "markdown"
language-servers = [
  "discord-rpc",
  "harper-ls",
  "markdown-oxide",
  "marksman",
]
formatter = { command = "prettierd", args = [".md"] }

[[language]]
name = "typst"
language-servers = [
  "discord-rpc",
  "harper-ls",
  "tinymist",
]

[[language]]
name = "toml"
language-servers = [
  "tombi",
  "discord-rpc"
]
